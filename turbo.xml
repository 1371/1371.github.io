<?xml version="1.0" encoding="utf-8"?>
<rss xmlns:yandex="http://news.yandex.ru" xmlns:media="http://search.yahoo.com/mrss/" version="2.0">
<channel>
<title>Николай Дубков</title>
<link>http://dubkov.xyz</link>
<description>Приветствую, @username! Я не могу рассказать о себе использовав только 160 символов гипертекста. Подробнее обо мне, можно узнать на моей домашней страничке.</description>
<yandex:analytics type="Yandex" id="44298044"/>
<item turbo="true">
  <link>http://dubkov.xyz/security/wi-fi-protected-setup.html</link>
  <title>Безопасность стандарта WPS</title>
  <author>Николай Дубков</author>
  <category>Безопасность</category>
  <pubDate>Sun, 02 Feb 14 09:30:52 +0300</pubDate>
<turbo:content>

<![CDATA[

<figure><img src="http://dubkov.xyz/assets/img/router.jpg" /></figure>
<p>Многим, кто увлекается беспроводными технологиями еще с 2011 года известно о найденной уязвимости в протоколе WPS. Данная уязвимость позволяет злоумышленнику получить доступ к роутеру за считанные часы. Сегодня любой желающий вооружившись оборудованием и специализированным ПО с легкостью сможет проникнуть в роутер соседа.</p>

<h1>Что такое WPS?</h1>
<p>Обратившись к поисковой машине Google с запросами: взлом wps, как взломать wifi, проcмотрев топ, я понял, что большинство блоггеров льют сплошную воду, рассказывая о данной уязвимости.</p>
<p>Но сейчас не об этом. На самом деле, не нужно быть специалистом в беспроводных сетях или отчаянным хакером, чтобы подобрать пароль к роутеру. В этом посте я хотел бы рассказать о подборе PIN и получении ключа WPA-PSK.</p>
<p>Итак, с чем мы имеем дело? <strong>Wi-Fi Protected Setup</strong> (сокр. WPS) – это стандарт, который присутствует практически во всех современных роутерах. Данный стандарт служит для упрощения настройки беспроводного соединения. Подробнее об этом протоколе можно прочитать в Википедии. Мы же воспользуемся уязвимостью стандарта для получения пароля защищенной сети.</p>

<h2>Инструменты</h2>
<p>Если у вас нет необходимого оборудования для <i>вардрайвинга</i> (поиска и использования уязвимостей), советую приобрести. Самым выгодным приобретением будут продукты от фирм <strong>Alfa</strong> и <strong>TP-Link</strong>. Для анализа сетей, подбора PIN, и получения хендшейков отлично подойдут такие модели адаптеров как <strong>Alfa AWUS036H</strong> (<i>036NH 2W</i>) и <strong>TP-Link TL-WN7200ND</strong>. Вооружившись данным инструментом, переходим к выбору ПО.</p>
<p>Обычно для таких целей как получение хендшейка, подбора PIN от WPS используют <strong>BackTrack</strong>. Но я бы не стал ударяться с головой в этот продукт. Так как нас интересует подбор PIN, то советую использовать продукт под названием <strong>WifiSlax</strong>. Версия ПО неважна, можно установить как 4.1, так и финальную на данный момент. При написании этого поста я использовал Wifislax 4.3.</p>
<p>Если вы пользуетесь Ubuntu, Backtrack и другими дистрибутивами Linux, установите <strong>minidwep-gtk</strong> на используемый вами дистрибутив.</p>

<h3>Анализ сети</h3>
<p>Итак, запускаем Wifislax. В данной сборке присутствует много различных программ, но в данный момент нам необходим <strong>minidwep-gtk</strong>. Прежде чем запускать программу, нужно понимать некоторые критерии удачного (быстрого) подбора. Многие, кто пытается подобрать PIN первый раз либо не знают о данных критериях, либо пренебрегают ими. Критерии подбора:</p>

<ul>
  <li>Качество сигнала</li>
  <li>Поддержка роутером WPS</li>
  <li>WPS должен быть включен на устройстве</li>
  <li>Пользователь не установил лимит подключений</li>
</ul>

<p>Обычно, неудачи связанные с анализом уязвимой сети связаны с этими критериями. Интерфейс minidwep-gtk выглядит следующим образом:</p>

<figure>
<img src="http://dubkov.xyz/assets/img/minidwep-gtk.png">
</figure>

<p>Для анализа сети, нам необходима кнопка <strong>Scan</strong>. После удачного сканирования сетей, необходимо проанализировать потенциально уязвимые сети. Для это нужно воспользоваться критериями изложенными выше.</p>

<figure>
<img src="http://dubkov.xyz/assets/img/minidwep-gtk_2.png">
</figure>

<p>Я выбрал точку с хорошим качеством сигналом и включенным WPS (состояние функции WPS, можно рассмотреть в строке сканированной сети, если в конце строки WPS отсутствует – данная сеть (роутер) не поддерживает wps или он просто выключен).</p>

<p>Теперь необходимо перейти к встроенному <strong>Reaver</strong>, вторая необходимая кнопка в minidwep-gtk. Важно отметить, что Reaver многофункционален и имеет широкий спектр настроек, упрощающих подбор.</p>

<figure>
<img src="http://dubkov.xyz/assets/img/minidwep-gtk_3.png">
</figure>

<p>Сам процесс подбора, выглядит банально простым. Пользователю, остается лишь ждать. По моей личной статистике, 3 точки из 10 – уязвимы. Среднее время подбора составляет около часа. Качественный сигнал обеспечивает высокую скорость подбора <strong>~1-3 seconds/pin</strong>. В случае удачного подбора PIN, программа уведомляет пользователя. В окне уведомления содержится полезная информация в виде PIN и ключа WPA-PSK.</p>

<figure>
<img src="http://dubkov.xyz/assets/img/minidwep-gtk_4.png">
</figure>

<h3>Ошибки и безопасность</h3>

<p>Одна из самых распространенных ошибок при подборе PIN в программе Reaver: <u>WARNING: Detected AP rate limiting, waiting 60 seconds</u>.</p>

<p>Данная ошибка означает, что на точке установлен лимит подключений. Подобрать PIN на такой точке довольно трудно, потребуется очень много времени для постепенного перебора. В сети есть несколько интересных вариаций команд для Reaver, обеспечивающих обход данного лимита, но, как оказалось, они актуальны только для определенных моделей роутеров.</p>
<p>Почему я остановился на данной ошибке? Устанавливая лимит подключений на своем роутере, пользователь обеспечивает себе защиту от подбора. Это один из критериев безопасности точки доступа Wi-Fi.</p>

<p>Если точка слишком далеко и качество сигнала оставляет желать лучшего, в консоли Reaver можно увидеть следующее: <u>WPS Transaction Failed (Code 0x02)</u>.</p>

<p>По своей сути WPS как доп. функция роутера непопулярна среди пользователей. Сегодня, производители маршрутизаторов с поддержкой WPS, пытаются особым образом присваивать стандартные пароли, которые труднее подобрать (особенно дело касается подбора скриптом для роутеров ZyXel Keenetic, пароли которых подбираются скриптом).</p>

<p>Для безопасности роутера, советую либо отключить данную функцию, либо обратить внимание на два критерия безопасного использования функции WPS:</p>

<ul>
<li>Установка нестандартного пароля (PIN)</li>
<li>Установка лимита подключений (Rate limit)</li>
</ul>

<p>Снижение пропускной способности и установка личного пароля, защитят роутер от потенциальной атаки. Про данную уязвимость можно говорить бесконечно, обычно проблемы с подбором возникают в результате несовместимого для этой цели оборудования и ПО, а так же, пренебрежение критериями. Данная уязвимость позволяет злоумышленнику получить доступ к роутеру за считанные часы.</p>
]]>

<yandex:related>
    <link url="http://dubkov.xyz/security/hack-wps.html" img="http://dubkov.xyz/assets/img/wireless.jpg">Взлом стандарта WPS</link>
    <link url="http://dubkov.xyz/security/hack-wi-fi-windows.html" img="http://dubkov.xyz/assets/img/hack-wi-fi.png">Взлом Wi-Fi из под Windows</link>
</yandex:related>
 </turbo:content>
 </item>
</channel>
</rss>
