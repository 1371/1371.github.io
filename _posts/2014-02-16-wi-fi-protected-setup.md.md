---
layout: post
date: 2014-02-16 14:20:44 +0300
title: "Безопасность стандарта WPS"
description: Безопасность стандарта WPS: взлом Wi-Fi и защита роутера от потенциальной атаки.
keywords: wi-fi, wps, взлом wi-fi, взлом wps, протокол, стандарт
mood: happy
comments: false
category:
- security
tags:
---
## Безопасность стандарта WPS

<figure>
    <img src="http://dubkov.xyz/assets/img/router.jpg" alt="Роутер" />
</figure>

Многим, кто увлекается беспроводными технологиями еще с 2011 года известно о найденной уязвимости в протоколе WPS. Данная уязвимость позволяет злоумышленнику получить доступ к роутеру за считанные часы. Сегодня любой желающий вооружившись оборудованием и специализированным ПО  с легкостью сможет проникнуть в роутер соседа.
<!--more-->
<h3>Что такое WPS?</h3>
Обратившись к поисковой машине Google с запросами:  взлом wps, как взломать wifi, проcмотрев топ, я понял, что большинство блоггеров льют сплошную воду, рассказывая о данной уязвимости.

Но сейчас не об этом. На самом деле, не нужно быть специалистом в беспроводных сетях или отчаянным хакером, чтобы подобрать пароль к роутеру. В этом посте я хотел бы рассказать о подборе PIN и получении ключа WPA-PSK.

Итак, с чем мы имеем дело? <b>Wi-Fi Protected Setup</b> (сокр. WPS) - это стандарт, который присутствует практически во всех современных роутерах. Данный стандарт служит для упрощения настройки беспроводного соединения. Подробнее об этом протоколе можно прочитать в Википедии. Мы же воспользуемся уязвимостью стандарта для получения пароля защищенной сети.

<h3>Инструменты</h3>
Если у вас нет необходимого оборудования для <i>вардрайвинга</i> (поиска и использования уязвимостей), советую приобрести. Самым выгодным приобретением будут продукты от фирм <b>Alfa</b> и <b>TP-Link</b>. Для анализа сетей, подбора PIN, и получения хендшейков отлично подойдут такие модели адаптеров как <b>Alfa AWUS036H</b> (<i>036NH 2W</i>) и <b>TP-Link TL-WN7200ND</b>. Вооружившись данным инструментом, переходим к выбору ПО.

Обычно для таких целей как получение хендшейка, подбора PIN от WPS используют <b>BackTrack</b>. Но я бы не стал ударяться с головой в этот продукт. Так как нас интересует подбор PIN, то советую использовать продукт под названием <b>WifiSlax</b>. Версия ПО неважна, можно установить как 4.1, так и финальную на данный момент. При написании этого поста я использовал Wifislax 4.3.

Если вы пользуетесь Ubuntu, Backtrack и другими дистрибутивами Linux, установите <b>minidwep-gtk</b> на используемый вами дистрибутив.

<h3>Анализ сети</h3>
Итак, запускаем Wifislax. В данной сборке присутствует много различных программ, но в данный момент нам необходим <b>minidwep-gtk</b>. Прежде чем запускать программу, нужно понимать некоторые критерии удачного (быстрого) подбора. Многие, кто пытается подобрать PIN первый раз либо не знают о данных критериях, либо пренебрегают ими. Критерии подбора:
<ul>
<li>Качество сигнала<br /></li>
<li>Поддержка роутером WPS</li>
<li>WPS должен быть включен на устройстве</li>
<li>Пользователь не установил лимит подключений</li>
</ul>

Обычно, неудачи связанные с анализом уязвимой сети связаны с этими критериями. Интерфейс <b>minidwep-gtk</b> выглядит следующим образом:

![minidwep-gtk]({{ site.url }}/assets/img/minidwep-gtk.png)

Для анализа сети, нам необходима кнопка <b>Scan</b>. После удачного сканирования сетей, необходимо проанализировать потенциально уязвимые сети. Для это нужно воспользоваться критериями изложенными выше.

![minidwep-gtk]({{ site.url }}/assets/img/minidwep-gtk_2.png)

Я выбрал точку с хорошим качеством сигналом и включенным WPS (<i>состояние функции WPS, можно рассмотреть в строке сканированной сети, если в конце строки WPS отсутствует - данная сеть (роутер) не поддерживает wps или он просто выключен</i>). Теперь необходимо перейти к встроенному <b><u>R</u>eaver</b>, вторая необходимая кнопка в minidwep-gtk. Важно отметить, что Reaver многофункционален и имеет широкий спектр настроек, упрощающих подбор.

![minidwep-gtk]({{ site.url }}/assets/img/minidwep-gtk_3.png)

Сам процесс подбора, выглядит банально простым. Пользователю, остается лишь ждать. По моей личной статистике, 3 точки из 10 - уязвимы. Среднее время подбора составляет около часа. Качественный сигнал обеспечивает высокую скорость подбора ~<b>1-3 seconds/pin</b>. В случае удачного подбора PIN, программа уведомляет пользователя. В окне уведомления содержится полезная информация в виде PIN и ключа WPA-PSK.

![minidwep-gtk]({{ site.url }}/assets/img/minidwep-gtk_4.png)

<h3>Ошибки и безопасность</h3>
Одна из самых распространенных ошибок при подборе PIN в программе Reaver: <code>WARNING&#58; Detected AP rate limiting, waiting 60 seconds</code>

Данная ошибка означает, что на точке установлен лимит подключений. Подобрать PIN на такой точке довольно трудно, потребуется очень много времени для постепенного перебора. В сети есть несколько интересных вариаций команд для Reaver, обеспечивающих обход данного лимита, но, как оказалось, они актуальны только для определенных моделей роутеров. Почему я остановился на данной ошибке? Устанавливая лимит подключений на своем роутере, пользователь обеспечивает себе защиту от подбора. Это один из критериев безопасности точки доступа Wi-Fi.

Если точка слишком далеко и качество сигнала оставляет желать лучшего, в консоли Reaver можно увидеть следующее: <code>WPS Transaction Failed (Code 0x02)</code>

Данная ошибка так же является одной из самых распространенных. <br /><br />По своей сути WPS как доп. функция роутера непопулярна среди пользователей. Сегодня, производители маршрутизаторов с поддержкой WPS, пытаются особым образом присваивать стандартные пароли, которые труднее подобрать (<i>особенно дело касается подбора скриптом для роутеров ZyXel Keenetic, пароли которых подбираются скриптом</i>). Для безопасности роутера, советую либо отключить данную функцию, либо обратить внимание на два критерия безопасного использования функции WPS:
<ul>
<li>Установка нестандартного пароля (PIN)</li>
<li>Установка лимита подключений (Rate limit)</li>
</ul>

Снижение пропускной способности и установка личного пароля, защитят роутер от потенциальной атаки. Про данную уязвимость можно говорить бесконечно, обычно проблемы с подбором возникают в результате несовместимого для этой цели оборудования и ПО, а так же, пренебрежение критериями. Данная уязвимость позволяет злоумышленнику получить доступ к роутеру за считанные часы.

>Дополнительно про уязвимости и взлом WPS, можно почитать в статье <a href="/wireless/hack-wps/">взлом стандарта WPS</a>