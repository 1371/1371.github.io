---
layout: post
date: 2015-12-24 15:22:57 +0300
title: "Взлом стандарта WPS"
description: Взлом стандарта WPS — новые методы взлома Wi-Fi и подбора PIN от WPS.
keywords: wi-fi, wps, взлом wi-fi, взлом wps, протокол, стандарт
mood: happy
comments: false
category:
- security
tags:

---

<figure>
    <img src="http://dubkov.xyz/assets/img/wireless.jpg" alt="Беспроводная сеть" />
</figure>

По моей скромной традиции, первый пост в моем блоге, после его реанимации, я напишу про Wi-Fi. Спустя год после моего отсутствия для протокола WPS, снова написали довольно неплохой скрипт, который в отличии от предыдущих, получает PIN и пароль в разы быстрее и, сам по себе проще в использовании.
<!--more-->
Наверно по великой случайности все посты, гайды и мануалы о безопасности в беспроводных сетях, кроме моих и еще некоторых ребят, как для новичков, так и опытных являются бредом сивой кобылы и непоняточкой, я вновь расскажу, как на практике взломать Wi-Fi с помощью уязвимости в WPS. Удивительно, что производители до сей поры не отказались от стандарта WPS.

<h2>Безопасность стандарта WPS</h2>
В этом материале Вы не увидите брута WPA/WPA2, три года назад это было актуальным, сегодня, тратить время на изучение и принципы подбора пароля, я считаю неуместным. Я хочу рассказать о дырявом стандарте WPS.

`Attention!! Данная информация не является руководством к использованию уязвимостей. Изложенный материал носит исключительно информационный характер. Авторы ресурса не несут абсолютно никакой ответственности за использование материала третьими лицами.`

<h2>Программа для взлома Wi-Fi</h2>
Да нет никакой программы для взлома Wi-Fi, если такой скрипт как PixieWPS или утилиту WiFite, можно назвать программами, то пусть будет по вашему. Для меня это инструменты, но никак не программы.

Вооружившись по старинке Wi-Fi адаптером, а я по-прежнему советую использовать либо TP-Link 7200ND либо Alfa Network AWUS036H. Можно приступить к установке дистрибутива Kali Linux или системы для вардрайвинга WiFislax.
Но для начала советую, прочитать <a href="http://dubkov.xyz/security/wi-fi-protected-setup.html">мой первый мануал про уязвимость в стандарте WPS</a>. Это именно тот разбор полетов, который был актуален почти три года назад.

Если вы сидите из под Windows, <a href="http://dubkov.xyz/linux/kali-linux-install-virtualbox.html">установите виртуальную машинку</a> с дистрибутивами Linux на борту.

<h3>Взлом Wi-Fi</h3>
<h5>+ видео</h5>
Для взлома Wi-Fi необходимы:

`Wi-Fi адаптер`

`Виртуальная машина или флешка с дистрибутивом Kali Linux или WiFislax`

В первом примере я буду работать с утилитой для пентестинга беспроводной сети Wi-Fi под названием WiFite, она доступна "из коробки" в дистрибутиве Kali Linux.
Запускаем дистрибутив Kali Linux, ищем утилиту WiFite. Открываем командую строку, пишем:

`wifite`

![Kali Linux]({{ site.url }}/assets/img/kali.wifite.png)

Один мой адаптер на AWUS036NH, наотрез отказывается работать с утилитой WiFite. Важно сказать, что практически все AWUS, кроме модели 036, самой популярной, постоянно имеют проблемы то с утилитами, то с драйверами.

До недавнего времени, я считал, что чипы ATHEROS, грубо говоря - маломощные и не присоблены для таких целей и приобретать их не стоит. Ошибался. Отложив Afla Network в сторону, я подключил маленький сетевой адаптер, размером с флешку - TP-Link TL-WN722N.

Утилита WiFite сама переводит железку в Monitor Mode и начинает мониторить доступные сети. Мне осталось всего лишь выбрать потенциально уязвимую сеть. У меня они под номером 7 и 8. В таблице сетей обращаем внимание на доступность WPS и качество сигнала, соответственно.

![WiFite]({{ site.url }}/assets/img/kali.wifite-2.png)

Буквально за несколько секунд получаем результат. Пароли и PINы на моих рисунках потёрты, естественно. Скрипт отдает пароли от двух уязвимых сетей.
Роутеры под названием Smart-Box очень популярны в нескольких, а может быть и во всех регионах России и принадлежат провайдеру Билайн. Насколько мне известно, данный провайдер, некоторое время назад использует другие роутеры, с другими прошивками.

![WiFite]({{ site.url }}/assets/img/kali.wifite-3.png)

<h4>Видео</h4>

<iframe width="600" height="315" src="https://www.youtube.com/embed/pI07mdgma_4" frameborder="0" allowfullscreen></iframe>

Важно отметить, что WiFite работает не только с WPS уязвимостью и довольно гибко настраиваться. Но я его использую достаточно редко.
Второй вариант использования это уязвимости - утилита PixieWPS из "коробки" WiFislax.
<h3>PixieScript в WiFislax</h3>
<h5>+ видео</h5>

Запускаем на виртуальной машине или с флешки дистрибутив системы для вардрайвинга WiFislax. Из огромного количества скриптов, нас интересует только один, он называется
В отличии от WiFite, здесь GUI интерфейс, а не командная строка.

Сам скрипт находиться в разделе Wifislax > Wpa wps

На картинке изображен путь до необходимого скрипта.

![Pixie Script]({{ site.url }}/assets/img/pixiescript.png)

В этом скрипте работать еще проще. Открываем интерфейса, жмем на кнопку, которая активирует Monitor Mode - MODO MONITOR.

Теперь ищем доступные в окрестностях сети - INICIAR ESCANEO

Выбираем подходящую сеть по критерию доступности стандарта WPS и качестве сигнала. Выбрали? Жмем - INICIAR ATAQUE

Ожидаем. Получаем результат. Обычно напротив атакованной сети появляется звезда или галочка. Значит все окей.

![Pixie Script]({{ site.url }}/assets/img/wps-crack-pixie.png)

Переходим на вкладку ATAQUE и анализируем полученные данные.
У данного скрипта есть несколько интересных возможностей, но писать о них у меня нет возможности. Этот скрипт так же подвергается гибкой настройке и использовать его сплошное удовольствие.

![Pixie Script]({{ site.url }}/assets/img/info-wifi.png)

<h4>Видео</h4>

<iframe width="600" height="315" src="https://www.youtube.com/embed/LzuhI3qP9bc" frameborder="0" allowfullscreen></iframe>

<h4>Другие способы взлома Wi-Fi</h4>
Существует еще несколько способов взлома Wi-Fi роутера с использованием других уязвимостей. Но они либо дополняют данный способ, либо являются менее эффективными.